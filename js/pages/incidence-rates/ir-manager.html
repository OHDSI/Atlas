<heading-title params="name: incidenceRateCaption(), icon: 'bolt', theme: 'dark'"></heading-title>
<div data-bind="visible:!loading()">
	<!-- ko if: selectedAnalysis() -->
	<div>
		<div class="asset-heading">
			<div class="input-group ir-header">
				<input type="text" placeholder="New Incidence Rate Analysis" class="form-control ir-name" data-bind="textInput: selectedAnalysis().name, css: { emptyInput: !isNameFilled() }, enable: isEditable"/>
				<div class="input-group-btn" role="group">
					<button class="btn btn-success" title="Save" data-bind="click: save, enable: canSave() && !isProcessing(), css: {'btn-success': canSave()}"><i class="fa fa-save"></i></button>
					<button class="btn btn-primary" title="Close" data-bind="click: closeAndShowList, enable: !isProcessing()"><i class="fa fa-times"></i></button>
					<!-- ko if: selectedAnalysis().id() != null -->
					<button class="btn btn-primary" title="Create a copy" data-bind="click: copy, enable: canCopy && !isProcessing(), css: {'disabled': !canCopy()}"><i class="fa fa-copy"></i></button>
					<button class="btn btn-primary" title="Configure access" data-bind="visible: isOwner, click: () => isAccessModalShown(!isAccessModalShown())">
						<i class="fa fa-lock"></i>
					</button>
					<!-- ko ifnot: isRunning -->
					<button class="btn btn-danger" title="Delete" data-bind="click: $component.delete, enable: isDeletable, css: { 'disabled': !isDeletable() || isProcessing() }"><i class="fa fa-trash-o"></i></button>
					<!-- /ko -->
					<!-- /ko -->
				</div>
			</div>
			<div data-bind="visible: !isNameFilled()" class="empty-name-error">
				<i class="fa fa-exclamation-circle" aria-hidden="true"></i>
				<label>Incidence Rate Analysis name is empty.</label>
			</div>
		</div>

		<tabs params="
        tabs: [
            {
                title: 'Definition',
                componentName: 'ir-definition',
                componentParams: { parent: $component },
            },
            {
                title: 'Concept Sets',
                componentName: 'ir-conceptsets',
                componentParams: { parent: $component },
            },
            {
                title: 'Generation',
                componentName: 'ir-generation',
                componentParams: { parent: $component },
            },
            {
                title: 'Utilities',
                componentName: 'ir-utilities',
                componentParams: { parent: $component },
            },
            {
                title: 'Export',
                componentName: 'component-sql-export',
                componentParams: { parent: $component },
            },
    ]"></tabs>
	</div>

	<div data-bind="modal: showConceptSetBrowser" class="modal fade" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">Select Concept Set...</div>
				<div class="paddedWrapper">
					<cohort-concept-set-browser params="criteriaContext: criteriaContext, cohortConceptSets: selectedAnalysis().expression().ConceptSets, onActionComplete: onConceptSetSelectAction"></cohort-concept-set-browser>
				</div>
			</div>
		</div>
	</div>
	<!-- /ko -->
</div>
<div data-bind="visible:loading()" class="loading">loading</div>

<configure-access-modal params="
	isModalShown: $component.isAccessModalShown,
	isOwnerFn: $component.isOwnerFn,
	loadAccessListFn: $component.loadAccessList,
	grantAccessFn: $component.grantAccess,
	revokeAccessFn: $component.revokeAccess,
	loadRoleSuggestionsFn: $component.loadAccessRoleSuggestions
"></configure-access-modal>