<access-denied params="isAuthenticated: isAuthenticated, isPermitted: isAuthenticated"></access-denied>

<div data-bind="css: classes('container')">

    <div data-bind="css: classes('section', 'radio')">
        <label for="assignRadio">
            <input id="assignRadio" type="radio" name="assignOrRemoveRadio" value="assign" data-bind="checked: actionType"> Assign tags
        </label>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <label for="removeRadio">
            <input id="removeRadio" type="radio" name="assignOrRemoveRadio" value="unassign" data-bind="checked: actionType"> Unassign tags
        </label>
    </div>

    <div data-bind="css: classes('section', 'tags')">
        <h4>Select tags</h4>
        <div data-bind="css: classes('tags-to-handle')">
            <b>Selected tags:</b> <span data-bind="if: tags().length === 0">none</span>
            <tags-badges-list params="{tags: tags, removable: true, removeFunc: unselectTag}"></tags-badges-list>
        </div>
        <div data-bind="css: classes('tags-component')">
            <table data-bind="
                css: classes({ extra: ['table', 'table-bordered', 'table-hover'] }),
                dataTable:{
                    data: availableTags,
                    options: {
                        order: [],
                        columns: tagsColumns,
                        pageLength: tableOptions.pageLength,
                        lengthMenu: tableOptions.lengthMenu,
                        language: ko.i18n('datatable.language')
                    },
                }
            "/>
        </div>
    </div>

    <div data-bind="css: classes('section', 'entities')">
        <h4>Select assets</h4>
        <div data-bind="css: classes('assets-to-handle')">
            <div data-bind="if: selectedConceptSets().length === 0 && selectedCohorts().length === 0 &&
                    selectedCharacterizations().length === 0 && selectedIncidenceRates().length === 0 &&
                    selectedPathways().length === 0 && selectedReusables().length === 0"><b data-bind="css: classes('assets')">Selected assets:</b> none
            </div>
            <div data-bind="if: selectedConceptSets().length > 0"><b>Concept Sets:</b>
                <div data-bind="foreach: selectedConceptSets(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
                        <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectConceptSet($data)"><i class="fa fa-times"></i></span>
                    </div>
                </div>
            </div>
            <div data-bind="if: selectedCohorts().length > 0"><b>Cohorts:</b>
                <div data-bind="foreach: selectedCohorts(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
                        <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectCohort($data)"><i class="fa fa-times"></i></span>
                    </div>
                </div>
            </div>
            <div data-bind="if: selectedCharacterizations().length > 0"><b>Characterizations:</b>
                <div data-bind="foreach: selectedCharacterizations(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
		                <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectCharacterization($data)"><i class="fa fa-times"></i></span>
                    </div>
                </div>
            </div>
            <div data-bind="if: selectedIncidenceRates().length > 0"><b>Incidence Rates:</b>
                <div data-bind="foreach: selectedIncidenceRates(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
                        <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectIncidenceRate($data)"><i class="fa fa-times"></i></span>&nbsp;&nbsp;
                    </div>
                </div>
            </div>
            <div data-bind="if: selectedPathways().length > 0"><b>Cohort Pathways:</b>
                <div data-bind="foreach: selectedPathways(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
                        <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectPathway($data)"><i class="fa fa-times"></i></span>
                    </div>
                </div>
            </div>
            <div data-bind="if: selectedReusables().length > 0"><b>Reusables:</b>
                <div data-bind="foreach: selectedReusables(), css: classes('assets')">
                    <div data-bind="css: $component.classes('asset')">
                        <span data-bind="text: id" title="id"></span>
                        <span data-bind="text: name"></span>
		                <span data-bind="click: () => $component.unselectReusable($data)"><i class="fa fa-times"></i></span>
                    </div>
                </div>
            </div>
        </div>
        <span></span>
        <div data-bind="component: { name: 'tabs', params: assetTabsParams }"></div>
    </div>

    <div data-bind="css: classes('button')">
        <!-- ko if: actionType() == 'assign' -->
        <button type="button" class="btn btn-primary"
                data-bind="click: doAssign, disable: !hasEnoughSelectedData()">Assign tags
        </button>
        <!-- /ko -->
        <!-- ko if: actionType() == 'unassign' -->
        <button type="button" class="btn btn-danger"
                data-bind="click: doUnassign, disable: !hasEnoughSelectedData()">Unassign tags
        </button>
        <!-- /ko -->
    </div>
</div>