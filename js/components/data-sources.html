<!-- ko if:$component.showSelectionArea -->
<div class="wrapperTitle">
	<span data-bind="if:!$component.model.loadingReport()"><i class="fa fa-area-chart"></i></span>
	<span data-bind="if:$component.model.loadingReport()"><i class="fa fa-circle-o-notch fa-spin"></i></span> Data Source Profiles
</div>

<div class="reportControls pad-5">
	<div class="row">
		<div class="col-xs-12">
			<select class="form-control" data-bind="css : { invalid: $component.currentReport()==undefined }, options:$component.reports(), optionsCaption:'Select a Report', optionsText:'name', value:$component.currentReport"></select>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12">
			<select class="form-control" data-bind="css : { invalid: $component.model.reportSourceKey()==undefined }, options:$component.model.services()[0].sources, optionsValue:'sourceKey', optionsText:'sourceName', value:$component.model.reportSourceKey, optionsCaption:'Select a Source'"></select>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-10"></div>

		<div class="col-xs-2">
			<button class="pull-right form-control btn btn-sm btn-primary" data-bind="click: $component.runReport, enable: $component.model.reportValid(), text: $component.model.loadingReport() ? 'Loading...' : 'View Report'"></button>
		</div>
	</div>

	<div class="clear"></div>
</div>
<!-- /ko -->

<div id="reportVisit" data-bind="if: $component.currentReport() == 'Visit' && !model.loadingReport()">
		<div class="pad-10 report">
			<div class="reportHeading"><i class="fa fa-area-chart"></i> Visit Report (<span data-bind="text:$component.model.reportSourceKey()"></span>)</div>
			<div class="reportSectionHeading">Visit Prevalence</div>

			<ul class="nav nav-tabs" id="myTab" role="tablist">
				<li class="active" id="treemap-tab"><a href="#visit-treemap-panel" role="tab" data-toggle="tab">Treemap</a>
				</li>
				<li><a href="#visit-table-panel" role="tab" data-toggle="tab">Table</a>
				</li>
			</ul>
			<div id='content' class="tab-content">
				<div role="tabpanel" class="tab-pane active" id="visit-treemap-panel">
					<div id="treemap_container">
						<div class="treemap_zoomtarget"></div>
					</div>
					<div class="treemap_legend">Box Size: Prevalence, Color: Records per Person (Light to Dark = Low to High), Use Ctrl-Click to Zoom, Alt-Click to Reset Zoom</div>
				</div>
				<div role="tabpanel" class="tab-pane" id="visit-table-panel" data-bind="eventListener: { event: 'click', selector: '.visit_table_selector', callback: handleVisitTableClick}">
					<table id="visit_table" class="display">
						<thead>
						<tr>
							<th>Concept Id</th>
							<th>Visit type</th>
							<th>Person Count</th>
							<th>Prevalence</th>
							<th>Records per Person</th>
						</tr>
						</thead>
					</table>
				</div>
			</div>

		</div>
</div>